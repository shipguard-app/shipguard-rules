# Detect hardcoded secrets and sensitive credentials
# This rule uses AI to scan for potential security vulnerabilities
# such as API keys, passwords, and private keys in your codebase.

name: "Block Hardcoded Secrets"
type: "ai-review"
severity: "error"
paths:
  include:
    - "**/*"
  exclude:
    - "package-lock.json"
    - "pnpm-lock.yaml"
    - "yarn.lock"
    - "*.lock"
prompt: |
  You are a security expert reviewing code for hardcoded secrets and sensitive credentials.
  
  Carefully scan the code changes for:
  - API keys (e.g., "api_key=", "apiKey:", "API_KEY=")
  - Authentication tokens (e.g., "Bearer ", "token=", "auth_token")
  - Passwords (e.g., "password=", "passwd:", "pwd=")
  - Private keys (e.g., "-----BEGIN PRIVATE KEY-----", "private_key=")
  - Database connection strings with credentials
  - AWS access keys (e.g., "AKIA" prefixes)
  - OAuth secrets or client secrets
  - Any long random strings that appear to be credentials (20+ alphanumeric characters)
  
  If you find any potential hardcoded secrets:
  1. Flag them as a security risk
  2. Explain what type of secret it appears to be
  3. Recommend using environment variables or a secrets manager instead
  
  If the code looks safe and uses proper environment variables or configuration management, approve it.